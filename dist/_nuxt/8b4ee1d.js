(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{366:function(t,e,o){var content=o(433);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(66).default)("cd12af58",content,!0,{sourceMap:!1})},432:function(t,e,o){"use strict";o(366)},433:function(t,e,o){var r=o(65)((function(i){return i[1]}));r.push([t.i,".container[data-v-79a79664]{width:100%}.title[data-v-79a79664]{text-align:center}.search-input[data-v-79a79664]{margin-bottom:10px;padding:8px;width:100%}.data-table[data-v-79a79664]{border-collapse:collapse;width:100%}.data-table td[data-v-79a79664],.data-table th[data-v-79a79664]{border:1px solid #ddd;padding:8px;text-align:left}.data-table th[data-v-79a79664]{background-color:#f4f4f4;cursor:pointer}button[data-v-79a79664]{background:#007bff;border:none;color:#fff;cursor:pointer;padding:5px 10px}.modal[data-v-79a79664]{align-items:center;background:rgba(0,0,0,.5);display:flex;height:100%;justify-content:center;left:0;position:fixed;top:0;width:100%}.modal-content[data-v-79a79664]{background:#fff;border-radius:5px;padding:20px;width:50%}",""]),r.locals={},t.exports=r},462:function(t,e,o){"use strict";o.r(e);o(23);var r=o(0),n=o(42),c=o(43),l=(o(3),o(5),o(97),o(20),o(98),o(390),o(250),o(7),o(8),o(6),o(2),o(143),o(62),o(395),o(403),o(405),o(406),o(407),o(409),o(410),o(411),o(412),o(413),o(414),o(415),o(416),o(418),o(419),o(420),o(421),o(422),o(423),o(424),o(425),o(426),o(427),o(428),o(4),o(68),o(429),o(254),o(72));function v(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,r)}return o}var d={layout:"menu",data:function(){return{formList:[],searchQuery:"",sortKey:"",sortOrders:{},selectedForm:null,uid:""}},computed:{filteredForms:function(){var t=this,e=Object(c.a)(this.formList).filter((function(form){return form.projectNameTh.includes(t.searchQuery)||form.contactName.includes(t.searchQuery)||form.email.includes(t.searchQuery)}));return this.sortKey&&e.sort((function(a,b){var e=t.sortOrders[t.sortKey]||1;return(a[t.sortKey]>b[t.sortKey]?1:-1)*e})),e}},mounted:function(){var t=this;l.a.auth().onAuthStateChanged((function(e){e?t.uid=e.uid:alert("กรุณาเข้าสู่ระบบก่อนส่งข้อมูล")})),this.fetchData()},methods:{showFiles:function(t){t?l.a.database().ref("files/".concat(t)).once("value",(function(t){var data=t.val();if(data){console.log("File Data:",data);for(var e=atob(data.fileData.split(",")[1]),o=new Array(e.length),i=0;i<e.length;i++)o[i]=e.charCodeAt(i);var r=new Uint8Array(o),n=new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),link=document.createElement("a");link.href=URL.createObjectURL(n),link.download=data.fileName,document.body.appendChild(link),link.click(),document.body.removeChild(link)}else console.error("No data found for the file ID")})):console.error("Invalid file ID")},fetchData:function(){var t=this;l.a.database().ref("T-VER-Form").on("value",(function(e){var data=e.val();t.formList=Object.entries(data||{}).map((function(t){var e=Object(n.a)(t,2);return function(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?v(Object(o),!0).forEach((function(e){Object(r.a)(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):v(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}({id:e[0]},e[1])}))}))},approveForm:function(form){confirm("คุณต้องการอนุมัติโครงการนี้หรือไม่?")&&(l.a.database().ref("T-VER-Form/".concat(form.id)).update({status:"2"}),alert("อนุมัติโครงการสําเร็จ"))},sortBy:function(t){this.sortOrders[t]=1===this.sortOrders[t]?-1:1,this.sortKey=t},showDetails:function(form){this.selectedForm=form}}},_=d,f=(o(432),o(52)),component=Object(f.a)(_,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("h1",{staticClass:"title"},[t._v("สถานะคำขอรับรองคาร์บอนเครดิต")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchQuery,expression:"searchQuery"}],staticClass:"search-input",attrs:{placeholder:"ค้นหาโครงการ..."},domProps:{value:t.searchQuery},on:{input:function(e){e.target.composing||(t.searchQuery=e.target.value)}}}),t._v(" "),e("table",{staticClass:"data-table"},[e("thead",[e("tr",[e("th",{on:{click:function(e){return t.sortBy("projectNameTh")}}},[t._v("ชื่อโครงการ")]),t._v(" "),e("th",[t._v("ประเภทโครงการ")]),t._v(" "),e("th",{on:{click:function(e){return t.sortBy("contactName")}}},[t._v("ชื่อผู้ประสานงาน")]),t._v(" "),e("th",[t._v("สถานะ")]),t._v(" "),e("th",{on:{click:function(e){return t.sortBy("date_submitForm")}}},[t._v("เวลาส่ง")]),t._v(" "),e("th",[t._v("รายละเอียด")]),t._v(" "),e("th",[t._v("ไฟล์เอกสาร")])])]),t._v(" "),e("tbody",t._l(t.filteredForms,(function(form){return e("tr",{key:form.id},[e("td",[t._v(t._s(form.projectNameTh))]),t._v(" "),e("td",[t._v(t._s(form.projectTypes.join(", ")))]),t._v(" "),e("td",[t._v(t._s(form.contactName))]),t._v(" "),e("td",[e("p",[t._v(t._s("1"===form.status?"รอตรวจสอบ":"ยืนยันแล้ว"))]),t._v(" "),"1"===form.status?e("input",{attrs:{type:"file"}}):t._e(),e("hr"),t._v(" "),"1"===form.status?e("button",{on:{click:function(e){return t.approveForm(form)}}},[t._v("ยืนยัน")]):t._e()]),t._v(" "),e("td",[t._v(t._s(new Date(form.date_submitForm).toLocaleString()))]),t._v(" "),e("td",[e("button",{on:{click:function(e){return t.showDetails(form)}}},[t._v("ดูรายละเอียด")])]),t._v(" "),e("td",[form.monitoringFiles1?e("a",{staticClass:"file-link",on:{click:function(e){return t.showFiles(form.monitoringFiles1)}}},[t._v("1 รายงานการติดตามประเมินผล")]):t._e(),t._v(" "),form.monitoringFiles2?e("a",{staticClass:"file-link",on:{click:function(e){return t.showFiles(form.monitoringFiles2)}}},[t._v("2 รายงานการติดตามประเมินผล")]):t._e(),t._v(" "),form.monitoringFiles3?e("a",{staticClass:"file-link",on:{click:function(e){return t.showFiles(form.monitoringFiles3)}}},[t._v("3 รายงานการติดตามประเมินผล")]):t._e(),t._v(" "),form.monitoringFiles4?e("a",{staticClass:"file-link",on:{click:function(e){return t.showFiles(form.monitoringFiles4)}}},[t._v("4 รายงานการติดตามประเมินผล")]):t._e(),e("hr"),t._v(" "),form.verificationFiles1?e("a",{staticClass:"file-link",on:{click:function(e){return t.showFiles(form.verificationFiles1)}}},[t._v("1 รายงานการตรวจสอบความใช้ได้โครงการ")]):t._e(),t._v(" "),form.verificationFiles2?e("a",{staticClass:"file-link",on:{click:function(e){return t.showFiles(form.verificationFiles2)}}},[t._v("2 รายงานการตรวจสอบความใช้ได้โครงการ")]):t._e(),t._v(" "),form.verificationFiles3?e("a",{staticClass:"file-link",on:{click:function(e){return t.showFiles(form.verificationFiles3)}}},[t._v("3 รายงานการตรวจสอบความใช้ได้โครงการ")]):t._e(),t._v(" "),form.verificationFiles4?e("a",{staticClass:"file-link",on:{click:function(e){return t.showFiles(form.verificationFiles4)}}},[t._v("4 รายงานการตรวจสอบความใช้ได้โครงการ")]):t._e(),e("hr"),t._v(" "),form.otherFiles1?e("a",{staticClass:"file-link",on:{click:function(e){return t.showFiles(form.otherFiles1)}}},[t._v("1 อื่น ๆ")]):t._e(),t._v(" "),form.otherFiles2?e("a",{staticClass:"file-link",on:{click:function(e){return t.showFiles(form.otherFiles2)}}},[t._v("2 อื่น ๆ")]):t._e(),t._v(" "),form.otherFiles3?e("a",{staticClass:"file-link",on:{click:function(e){return t.showFiles(form.otherFiles3)}}},[t._v("3 อื่น ๆ")]):t._e(),t._v(" "),form.otherFiles4?e("a",{staticClass:"file-link",on:{click:function(e){return t.showFiles(form.otherFiles4)}}},[t._v("4 อื่น ๆ")]):t._e()])])})),0)]),t._v(" "),t.selectedForm?e("div",{staticClass:"modal"},[e("div",{staticClass:"modal-content"},[e("h2",[t._v("รายละเอียดโครงการ")]),t._v(" "),e("p",[e("strong",[t._v("ชื่อโครงการภาษาอังกฤษ:")]),t._v(" "+t._s(t.selectedForm.projectNameEn))]),t._v(" "),e("p",[e("strong",[t._v("ชื่อโครงการภาษาไทย:")]),t._v(" "+t._s(t.selectedForm.projectNameTh))]),t._v(" "),e("p",[e("strong",[t._v("ประเภทโครงการ:")]),t._v(" "+t._s(t.selectedForm.projectTypes.join(", ")))]),t._v(" "),e("p",[e("strong",[t._v("อื่น ๆ:")]),t._v(" "+t._s(t.selectedForm.otherProjectType||"-"))]),t._v(" "),e("h3",[t._v("รายละเอียดผู้พัฒนาโครงการ")]),t._v(" "),e("p",[e("strong",[t._v("ชื่อผู้ประสานงาน:")]),t._v(" "+t._s(t.selectedForm.contactName))]),t._v(" "),e("p",[e("strong",[t._v("ที่อยู่:")]),t._v(" "+t._s(t.selectedForm.address))]),t._v(" "),e("p",[e("strong",[t._v("โทรศัพท์:")]),t._v(" "+t._s(t.selectedForm.phone))]),t._v(" "),e("p",[e("strong",[t._v("โทรสาร:")]),t._v(" "+t._s(t.selectedForm.fax||"-"))]),t._v(" "),e("p",[e("strong",[t._v("อีเมล:")]),t._v(" "+t._s(t.selectedForm.email))]),t._v(" "),e("button",{on:{click:function(e){t.selectedForm=null}}},[t._v("ปิด")])])]):t._e()])}),[],!1,null,"79a79664",null);e.default=component.exports}}]);