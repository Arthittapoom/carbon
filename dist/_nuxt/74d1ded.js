(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{440:function(e,t,r){var content=r(523);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(59).default)("08d151c3",content,!0,{sourceMap:!1})},522:function(e,t,r){"use strict";r(440)},523:function(e,t,r){var n=r(58)((function(i){return i[1]}));n.push([e.i,".container[data-v-2d58db3b]{font-family:Arial,sans-serif;margin:auto;max-width:1200px;padding:20px;width:100%}.title[data-v-2d58db3b]{font-size:24px;margin-bottom:20px;text-align:center}.search-input[data-v-2d58db3b]{border:1px solid #ccc;border-radius:5px;margin-bottom:15px;padding:10px;width:100%}.data-table[data-v-2d58db3b]{background:#fff;border-collapse:collapse;border-radius:8px;box-shadow:0 0 10px rgba(0,0,0,.1);overflow:hidden;width:100%}.data-table td[data-v-2d58db3b],.data-table th[data-v-2d58db3b]{border:1px solid #ddd;padding:12px;text-align:left}.data-table th[data-v-2d58db3b]{background-color:#2fa4b1;color:#fff;cursor:pointer}.data-table tr[data-v-2d58db3b]:nth-child(2n){background-color:#f9f9f9}button[data-v-2d58db3b]{background:#28a745;border:none;border-radius:5px;color:#fff;cursor:pointer;padding:8px 12px;transition:background .3s}button[data-v-2d58db3b]:hover{background:#218838}.file-link[data-v-2d58db3b]{color:#007bff;display:block;margin-bottom:5px;-webkit-text-decoration:none;text-decoration:none}.file-link[data-v-2d58db3b]:hover{-webkit-text-decoration:underline;text-decoration:underline}.modal[data-v-2d58db3b]{align-items:center;background:rgba(0,0,0,.5);display:flex;height:100%;justify-content:center;left:0;position:fixed;top:0;width:100%}.modal-content[data-v-2d58db3b]{background:#fff;border-radius:8px;box-shadow:0 0 10px rgba(0,0,0,.2);padding:20px;width:50%}",""]),n.locals={},e.exports=n},572:function(e,t,r){"use strict";r.r(t);r(24);var n=r(0),o=r(43),c=r(39),l=r(44),d=(r(79),r(3),r(5),r(98),r(21),r(99),r(392),r(37),r(253),r(7),r(8),r(6),r(2),r(143),r(65),r(393),r(394),r(395),r(396),r(397),r(398),r(399),r(400),r(401),r(402),r(403),r(404),r(405),r(406),r(407),r(409),r(410),r(411),r(412),r(413),r(414),r(415),r(416),r(417),r(4),r(68),r(418),r(254),r(73)),v=r(119),f=r.n(v);function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var h={layout:"menu",data:function(){return{formList:[],searchQuery:"",sortKey:"",sortOrders:{},selectedForm:null,uid:"",file:null,uploading:!1}},computed:{filteredForms:function(){var e=this,t=Object(l.a)(this.formList).filter((function(form){return form.projectNameTh.includes(e.searchQuery)||form.contactName.includes(e.searchQuery)||form.email.includes(e.searchQuery)}));return this.sortKey&&t.sort((function(a,b){var t=e.sortOrders[e.sortKey]||1;return(a[e.sortKey]>b[e.sortKey]?1:-1)*t})),t}},mounted:function(){var e=this;d.a.auth().onAuthStateChanged((function(t){t?e.uid=t.uid:f.a.fire({icon:"error",title:"เกิดข้อผิดพลาด",text:"กรุณาเข้าสู่ระบบ",confirmButtonText:"ตกลง",confirmButtonColor:"#007BFF"}).then((function(){e.$router.push("/login")}))})),this.fetchData()},methods:{showFiles:function(e){e?d.a.database().ref("files/".concat(e)).once("value",(function(e){var data=e.val();if(data){for(var t=atob(data.fileData.split(",")[1]),r=new Array(t.length),i=0;i<t.length;i++)r[i]=t.charCodeAt(i);var n=new Uint8Array(r),o=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),link=document.createElement("a");link.href=URL.createObjectURL(o),link.download=data.fileName,document.body.appendChild(link),link.click(),document.body.removeChild(link)}else console.error("No data found for the file ID")})):console.error("Invalid file ID")},handleFileChange:function(e){this.file=e.target.files[0]},uploadFile:function(form){var e=this;return Object(c.a)(regeneratorRuntime.mark((function t(){var r,n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.file){t.next=2;break}return t.abrupt("return");case 2:return e.uploading=!0,t.prev=3,t.next=6,e.fileToBase64(e.file);case 6:return r=t.sent,n=d.a.database().ref("T-VER-Form").child(form.id).child("files"),o=n.push(),t.next=11,o.set({fileName:e.file.name,fileData:r,uploadDate:(new Date).toLocaleString()});case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(3),console.error("Error uploading file:",t.t0);case 16:return t.prev=16,e.uploading=!1,t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[3,13,16,19]])})))()},fileToBase64:function(e){return Object(c.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){var n=new FileReader;n.onloadend=function(){return t(n.result)},n.onerror=r,n.readAsDataURL(e)})));case 1:case"end":return t.stop()}}),t)})))()},fetchData:function(){var e=this;d.a.database().ref("T-VER-Form").on("value",(function(t){var data=t.val();e.formList=Object.entries(data||{}).map((function(e){var t=Object(o.a)(e,2);return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach((function(t){Object(n.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({id:t[0]},t[1])}))}))},approveForm:function(form){confirm("คุณต้องการอนุมัติโครงการนี้หรือไม่?")&&console.log(form)},sortBy:function(e){this.sortOrders[e]=1===this.sortOrders[e]?-1:1,this.sortKey=e},showDetails:function(form){this.selectedForm=form}}},m=h,F=(r(522),r(53)),component=Object(F.a)(m,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("h1",{staticClass:"title"},[e._v("สถานะคำขอรับรองคาร์บอนเครดิต")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.searchQuery,expression:"searchQuery"}],staticClass:"search-input",attrs:{placeholder:"ค้นหาโครงการ..."},domProps:{value:e.searchQuery},on:{input:function(t){t.target.composing||(e.searchQuery=t.target.value)}}}),e._v(" "),t("table",{staticClass:"data-table"},[t("thead",[t("tr",[t("th",{on:{click:function(t){return e.sortBy("projectNameTh")}}},[e._v("ชื่อโครงการ")]),e._v(" "),t("th",[e._v("ประเภทโครงการ")]),e._v(" "),t("th",{on:{click:function(t){return e.sortBy("contactName")}}},[e._v("ชื่อผู้ประสานงาน")]),e._v(" "),t("th",[e._v("สถานะ")]),e._v(" "),t("th",{on:{click:function(t){return e.sortBy("date_submitForm")}}},[e._v("เวลาส่ง")]),e._v(" "),t("th",[e._v("รายละเอียด")]),e._v(" "),t("th",[e._v("ไฟล์เอกสาร")])])]),e._v(" "),t("tbody",e._l(e.filteredForms,(function(form){return t("tr",{key:form.id},[t("td",[e._v(e._s(form.projectNameTh))]),e._v(" "),t("td",[e._v(e._s(form.projectTypes.join(", ")))]),e._v(" "),t("td",[e._v(e._s(form.contactName))]),e._v(" "),t("td",[t("p",[e._v(e._s("1"===form.status?"รอตรวจสอบ":"ยืนยันแล้ว"))]),e._v(" "),"1"===form.status?t("input",{attrs:{type:"file"},on:{change:e.handleFileChange}}):e._e(),e._v(" "),"1"!==form.status||form.files?e._e():t("button",{staticClass:"mt-2",on:{click:function(t){return e.uploadFile(form)}}},[e._v("Upload")]),e._v(" "),t("hr"),e._v(" "),"1"===form.status?t("div",[t("p",[e._v("จำนวน carbon(ตัน) :")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:form.carbon,expression:"form.carbon"}],attrs:{type:"number"},domProps:{value:form.carbon},on:{input:function(t){t.target.composing||e.$set(form,"carbon",t.target.value)}}}),e._v(" "),t("p",[e._v("จำนวนระยะเวลา(ปี) :")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:form.year,expression:"form.year"}],attrs:{type:"number"},domProps:{value:form.year},on:{input:function(t){t.target.composing||e.$set(form,"year",t.target.value)}}})]):e._e(),e._v(" "),t("hr"),e._v(" "),"1"===form.status?t("button",{on:{click:function(t){return e.approveForm(form)}}},[e._v("ยืนยัน")]):e._e()]),e._v(" "),t("td",[e._v(e._s(new Date(form.date_submitForm).toLocaleString()))]),e._v(" "),t("td",[t("button",{on:{click:function(t){return e.showDetails(form)}}},[e._v("ดูรายละเอียด")])]),e._v(" "),t("td",[form.monitoringFiles1?t("a",{staticClass:"file-link",on:{click:function(t){return e.showFiles(form.monitoringFiles1)}}},[e._v("1\n            รายงานการติดตามประเมินผล")]):e._e(),e._v(" "),form.monitoringFiles2?t("a",{staticClass:"file-link",on:{click:function(t){return e.showFiles(form.monitoringFiles2)}}},[e._v("2\n            รายงานการติดตามประเมินผล")]):e._e(),e._v(" "),form.monitoringFiles3?t("a",{staticClass:"file-link",on:{click:function(t){return e.showFiles(form.monitoringFiles3)}}},[e._v("3\n            รายงานการติดตามประเมินผล")]):e._e(),e._v(" "),form.monitoringFiles4?t("a",{staticClass:"file-link",on:{click:function(t){return e.showFiles(form.monitoringFiles4)}}},[e._v("4\n            รายงานการติดตามประเมินผล")]):e._e(),e._v(" "),t("hr"),e._v(" "),form.verificationFiles1?t("a",{staticClass:"file-link",on:{click:function(t){return e.showFiles(form.verificationFiles1)}}},[e._v("1\n            รายงานการตรวจสอบความใช้ได้โครงการ")]):e._e(),e._v(" "),form.verificationFiles2?t("a",{staticClass:"file-link",on:{click:function(t){return e.showFiles(form.verificationFiles2)}}},[e._v("2\n            รายงานการตรวจสอบความใช้ได้โครงการ")]):e._e(),e._v(" "),form.verificationFiles3?t("a",{staticClass:"file-link",on:{click:function(t){return e.showFiles(form.verificationFiles3)}}},[e._v("3\n            รายงานการตรวจสอบความใช้ได้โครงการ")]):e._e(),e._v(" "),form.verificationFiles4?t("a",{staticClass:"file-link",on:{click:function(t){return e.showFiles(form.verificationFiles4)}}},[e._v("4\n            รายงานการตรวจสอบความใช้ได้โครงการ")]):e._e(),e._v(" "),t("hr"),e._v(" "),form.otherFiles1?t("a",{staticClass:"file-link",on:{click:function(t){return e.showFiles(form.otherFiles1)}}},[e._v("1 อื่น ๆ")]):e._e(),e._v(" "),form.otherFiles2?t("a",{staticClass:"file-link",on:{click:function(t){return e.showFiles(form.otherFiles2)}}},[e._v("2 อื่น ๆ")]):e._e(),e._v(" "),form.otherFiles3?t("a",{staticClass:"file-link",on:{click:function(t){return e.showFiles(form.otherFiles3)}}},[e._v("3 อื่น ๆ")]):e._e(),e._v(" "),form.otherFiles4?t("a",{staticClass:"file-link",on:{click:function(t){return e.showFiles(form.otherFiles4)}}},[e._v("4 อื่น ๆ")]):e._e()])])})),0)]),e._v(" "),e.selectedForm?t("div",{staticClass:"modal"},[t("div",{staticClass:"modal-content"},[t("h2",[e._v("รายละเอียดโครงการ")]),e._v(" "),t("p",[t("strong",[e._v("ชื่อโครงการภาษาอังกฤษ:")]),e._v(" "+e._s(e.selectedForm.projectNameEn))]),e._v(" "),t("p",[t("strong",[e._v("ชื่อโครงการภาษาไทย:")]),e._v(" "+e._s(e.selectedForm.projectNameTh))]),e._v(" "),t("p",[t("strong",[e._v("ประเภทโครงการ:")]),e._v(" "+e._s(e.selectedForm.projectTypes.join(", ")))]),e._v(" "),t("p",[t("strong",[e._v("อื่น ๆ:")]),e._v(" "+e._s(e.selectedForm.otherProjectType||"-"))]),e._v(" "),t("h3",[e._v("รายละเอียดผู้พัฒนาโครงการ")]),e._v(" "),t("p",[t("strong",[e._v("ชื่อผู้ประสานงาน:")]),e._v(" "+e._s(e.selectedForm.contactName))]),e._v(" "),t("p",[t("strong",[e._v("ที่อยู่:")]),e._v(" "+e._s(e.selectedForm.address))]),e._v(" "),t("p",[t("strong",[e._v("โทรศัพท์:")]),e._v(" "+e._s(e.selectedForm.phone))]),e._v(" "),t("p",[t("strong",[e._v("โทรสาร:")]),e._v(" "+e._s(e.selectedForm.fax||"-"))]),e._v(" "),t("p",[t("strong",[e._v("อีเมล:")]),e._v(" "+e._s(e.selectedForm.email))]),e._v(" "),t("button",{on:{click:function(t){e.selectedForm=null}}},[e._v("ปิด")])])]):e._e()])}),[],!1,null,"2d58db3b",null);t.default=component.exports}}]);